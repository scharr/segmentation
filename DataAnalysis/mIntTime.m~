function [intensities] = mIntTime(tifstk, labROI)
%[ output_args ] = mIntTime( input_args )
%   This takes a matrix representing a time lapse movie of fluorescent calcium
%   signalling in cells, and a corresponding labeled ROI mask, and calculates the mean
%   intensities of the cells over time.
%   It returns a matrix of mean intensities where each row is an individual
%   cell and each column is one frame.
%
%       tifstk:     uint8 or uint16 3D matrix
%       labROI:     label matrix of ROIs
%
% (in a previous version, this function took the filenames instead of the
% images themselves. Uncomment 
%     tif = readTifStack(imfname);
%     labROI = imread(labROIfname);
    dims = size(tifstk);
    
    if length(dims) == 2
        stats = regionprops(labROI,tifstk,'MeanIntensity');
        intensities = reshape([stats.MeanIntensity],size(stats));
    elseif length(dims) == 3
        numImages = dims(3);
        stats = regionprops(labROI,tifstk(:,:,1),'MeanIntensity');
        intensities = zeros(length(stats),numImages);  
    end
    
    for i = 1:numImages
        intensities(:,i) = (reshape([stats.MeanIntensity],size(stats)));
    end


end

