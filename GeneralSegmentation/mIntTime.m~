function [ intensities ] = mIntTime(imfname, labROI)
%[ output_args ] = mIntTime( input_args )
%   This takes a filename (string) of a time lapse movie of fluorescent calcium
%   signalling in cells, and a corresponding labeled ROI mask, and calculates the mean
%   intensities of the cells over time.
%   It returns a matrix of mean intensities where each row is an individual
%   cell and each column is one frame.

    tif = readTifStack(imfname);
    s = size(tif);
    if length(s) == 2
        stats = regionprops(labROI,tif,'MeanIntensity');
        intensities = reshape([stats.MeanIntensity],size(stats));
        
    elseif length(s) == 3
    dims = size(tifstack);
    numSlices = dims(3);
    numImages = numSlices/numChannels;
    step = numChannels;
    for i = 1:numChannels
        idx = i;
        for j = 1:numImages 
            temp = tifstack(:,:,idx);
            temp = uint8(temp);
            basefilename = sprintf('%s/%s_%d.tif',path,basenames{i},j);
            imwrite(temp,basefilename);
            idx = idx+step;
        end
    end


end

